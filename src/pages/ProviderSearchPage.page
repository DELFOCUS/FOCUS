<apex:page controller="ProviderSearchController" sidebar="false">
  
    <apex:form >
  <apex:pageMessages id="errors" />
 
  <apex:pageBlock title="Find Me A Provider!" mode="edit">
  
  <table width="100%" border="0">
  <tr>  
    <td width="37%" valign="top">

      <apex:pageBlock mode="edit" id="criteria" title="Provider Search">
      
      <script type="text/javascript">
      function doSearch() {
      
           var fname = document.getElementById("firstName").value;
          var lname = document.getElementById("lastName").value;
          var street = document.getElementById("street").value;
          var city = document.getElementById("city").value;
          var emergencyPro = document.getElementById("emrPro").options[document.getElementById("emrPro").selectedIndex].value
          var gtf = document.getElementById("gtf").options[document.getElementById("gtf").selectedIndex].value
          var refn = document.getElementById("refn").value;
          var refType = document.getElementById("refType").options[document.getElementById("refType").selectedIndex].value
          var state = document.getElementById("state").value;
          var zip = document.getElementById("zip").value;
          var apt = document.getElementById("apt").value;
          var phone = document.getElementById("phone").value;
          var parOrg = document.getElementById("parOrg").value;
          
          console.log('refn>'+refn+' refType '+refType); 
          searchServer(fname , lname,street,city,emergencyPro,gtf,refn,refType,state,zip,apt,phone,parOrg);
          
     
      }
         
      </script> 

      <apex:actionFunction name="searchServer" action="{!runSearch}" rerender="results,debug,errors">
          <apex:param name="firstName" value="" />
          <apex:param name="lastName" value="" />
          <apex:param name="street" value="" />
          <apex:param name="city" value="" />
          <apex:param name="emrPro" value="" />
          <apex:param name="gtf" value="" />
          <apex:param name="refn" value=""/>
          <apex:param name="refType" value=""/>
          <apex:param name="state" value=""/>
          <apex:param name="zip" value=""/>
          <apex:param name="apt" value=""/>
          <apex:param name="phone" value=""/>
          <apex:param name="parOrg" value=""/>
       </apex:actionFunction>
      <div id="test">
          <table >
          <tr>
            <td align="left">First Name </td>
            <td> <input type="text" id="firstName" />
              </td>
            
          </tr>
          <tr>
            <td align="left">Last Name</td>
             <td><input type="text" id="lastName" />
            </td>
          </tr>
          <tr>
            <td align="left">Emergency Provider</td>
             <td>
              <select id="emrPro" >
                <option value=""></option>
                <apex:repeat value="{!EmrgncyProVal}" var="emr">
                  <option value="{!emr}">{!emr}</option>
                </apex:repeat>
              </select>
            </td>
          </tr>
           <tr>
            <td align="left">GTF Level</td>
             <td>
              <select id="gtf" >
                <option value=""></option>
                <apex:repeat value="{!gtfLvl}" var="gtf">
                  <option value="{!gtf}">{!gtf}</option>
                </apex:repeat>
              </select>
            </td>
          </tr>
          <tr>
            <td align="left">Parent Organization</td>
             <td>
             <input type="text" id="parOrg" />
            </td>
          </tr>
              <tr>
            <td align="left">Alias</td>
             <td>
             <input type="text" id="phone1" />
            </td>
          </tr>
          <tr>
            <td align="left">Reference Type</td>
             <td>
              <select id="refType" >
                <option value=""></option>
                <apex:repeat value="{!refType}" var="ref">
                  <option value="{!ref}">{!ref}</option>
                </apex:repeat>
                  <input type="refn" id="refn" />
              </select>
            </td>
          </tr>
          
        
          </table>
     </div>
          
   
     
          
          
      </apex:pageBlock>

    </td>
      
    <td><apex:pageBlock mode="edit" id="Addcriteria" title="Address Search">
        <table >
          <tr>
            <td align="left">Street</td>
             <td>
             <input type="text" id="street" />
            </td>
          </tr>
          <tr>
            <td align="left">City</td>
             <td>
             <input type="text" id="city" />
            </td>
          </tr>
            <tr>
            <td align="left">State</td>
             <td>
             <input type="text" id="state" />
            </td>
          </tr>
            <tr>
            <td align="left">Zip Code</td>
             <td>
             <input type="text" id="zip" />
            </td>
          </tr>
             <tr>
            <td align="left">Suite / Apt</td>
             <td>
             <input type="text" id="apt" />
            </td>
          </tr>
          <tr>
            <td align="left">Phone</td>
             <td>
             <input type="text" id="phone" />
            </td>
          </tr>
            

        </table></apex:pageBlock>
    </td>
   <td><apex:pageBlock mode="edit" id="relCriteria" title="Related Search">
        <table >
          <tr>
            <td align="left">Provider Type</td>
             <td>
             <input type="text" id="street1" />
            </td>
          </tr>
          <tr>
            <td align="left">Status</td>
             <td>
             <input type="text" id="city1" />
            </td>
          </tr>
            <tr>
            <td align="left">Service Code </td>
             <td>
             <input type="text" id="state1" />
            </td>
          </tr>
            <tr>
            <td align="left">Service Description</td>
             <td>
             <input type="text" id="zip1" />
            </td>
          </tr>
          
          
            

        </table></apex:pageBlock>
    </td>
      </tr>
  
  <tr align="center">
      <table align="center"><tr>
      <td><apex:commandButton value="Search" onclick="javascript: doSearch();" rerender="dummy"/>  </td> 
      <td><apex:commandButton value="Clear"  rerender="results,debug"/>  </td> 
      <td><apex:commandButton value="New Provider"  rerender="results,debug"/>  </td> 
      </tr></table>
      
      
  </tr>
      
  
  <tr>
    <td valign="top">

    <apex:pageBlock mode="edit" id="results">
    
  
        <apex:pageBlockTable value="{!providers}" var="provider" width="100%">
           <!-- <apex:column >
                <apex:facet name="header">
                    <apex:commandLink value="ID" action="{!toggleSort}" rerender="results,debug">
                        <apex:param name="sortField" value="ID" assignTo="{!sortField}"/>
                    </apex:commandLink>
                </apex:facet>
                <apex:outputLink value="{!URLFOR($Action.Account.View, provider.id)}">
                    {!provider.id}
                </apex:outputLink>
               
            </apex:column>-->
            <apex:column >
                <apex:facet name="header">
                    <apex:commandLink value="First Name" action="{!toggleSort}" rerender="results,debug">
                        <apex:param name="sortField" value="firstName" assignTo="{!sortField}"/>
                    </apex:commandLink>
                </apex:facet>
                <apex:outputLink value="{!URLFOR($Action.Account.View, provider.id)}">
                    {!provider.DD_First_Name__c}
                </apex:outputLink>
               
            </apex:column>

            <apex:column >
                <apex:facet name="header">
                    <apex:commandLink value="Last Name" action="{!toggleSort}" rerender="results,debug">
                        <apex:param name="sortField" value="lastName" assignTo="{!sortField}"/>
                    </apex:commandLink>
                </apex:facet>
                <apex:outputField value="{!provider.DD_Last_Name__c}"/>
            </apex:column>
            <apex:column >
                <apex:facet name="header">
                    <apex:commandLink value="Emr Pro" action="{!toggleSort}" rerender="results,debug">
                        <apex:param name="sortField" value="emrPro" assignTo="{!sortField}"/>
                    </apex:commandLink>
                </apex:facet>
                <apex:outputField value="{!provider.DD_Emergency_Provider__c}"/>
            </apex:column>
            <apex:column >
                <apex:facet name="header">
                    <apex:commandLink value="GTF" action="{!toggleSort}" rerender="results,debug">
                        <apex:param name="sortField" value="gtf" assignTo="{!gtf}"/>
                    </apex:commandLink>
                </apex:facet>
                <apex:outputField value="{!provider.DD_GTF_Level__c}"/>
            </apex:column>
            <apex:column rendered="{!If($CurrentPage.parameters.city!=null,true,false)}">
                <apex:facet name="header">
                  <apex:commandLink value="City" action="{!toggleSort}" rerender="results,debug">
                        <apex:param name="sortField" value="city" assignTo="{!sortField}"/>
                    </apex:commandLink>  
                </apex:facet>
                <apex:outputPanel rendered="{!IF( provider.DEL_Provider_Addresses__r != null && provider.DEL_Provider_Addresses__r.size > 0,true, false)}">
                    <apex:outputText value="{!provider.DEL_Provider_Addresses__r[0].DD_City__c}"/>
                </apex:outputPanel>
            </apex:column>
            <apex:column rendered="{!If($CurrentPage.parameters.street!=null,true,false)}">
                <apex:facet name="header">
                    <apex:commandLink value="Street" action="{!toggleSort}" rerender="results,debug">
                        <apex:param name="sortField" value="street" assignTo="{!sortField}"/>
                    </apex:commandLink>
                 </apex:facet>
                 <apex:outputPanel rendered="{!IF( provider.DEL_Provider_Addresses__r != null && provider.DEL_Provider_Addresses__r.size > 0,true, false)}">
                    <apex:outputText value="{!provider.DEL_Provider_Addresses__r[0].Name}"/>
                </apex:outputPanel>
            </apex:column>
            <apex:column rendered="{!If($CurrentPage.parameters.state!=null,true,false)}">
                <apex:facet name="header">
                    <apex:commandLink value="Street" action="{!toggleSort}" rerender="results,debug">
                        <apex:param name="sortField" value="state" assignTo="{!sortField}"/>
                    </apex:commandLink>
                 </apex:facet>
                 <apex:outputPanel rendered="{!IF( provider.DEL_Provider_Addresses__r != null && provider.DEL_Provider_Addresses__r.size > 0,true, false)}">
                    <apex:outputText value="{!provider.DEL_Provider_Addresses__r[0].DD_State__c}"/>
                </apex:outputPanel>
            </apex:column>
            <apex:column rendered="{!If($CurrentPage.parameters.phone!=null,true,false)}">
                <apex:facet name="header">
                    <apex:commandLink value="Phone" action="{!toggleSort}" rerender="results,debug">
                        <apex:param name="sortField" value="phone" assignTo="{!sortField}"/>
                    </apex:commandLink>
                 </apex:facet>
                 <apex:outputPanel rendered="{!IF( provider.DEL_Provider_Addresses__r != null && provider.DEL_Provider_Addresses__r.size > 0,true, false)}">
                    <apex:outputText value="{!provider.DEL_Provider_Addresses__r[0].DD_Phone__c}"/>
                </apex:outputPanel>
            </apex:column>
            <apex:column rendered="{!If($CurrentPage.parameters.zip!=null,true,false)}">
                <apex:facet name="header">
                    <apex:commandLink value="Zip Code" action="{!toggleSort}" rerender="results,debug">
                        <apex:param name="sortField" value="zip" assignTo="{!sortField}"/>
                    </apex:commandLink>
                 </apex:facet>
                 <apex:outputPanel rendered="{!IF( provider.DEL_Provider_Addresses__r != null && provider.DEL_Provider_Addresses__r.size > 0,true, false)}">
                    <apex:outputText value="{!provider.DEL_Provider_Addresses__r[0].DD_Zip_Code__c}"/>
                </apex:outputPanel>
            </apex:column>
            <apex:column rendered="{!If($CurrentPage.parameters.apt!=null,true,false)}">
                <apex:facet name="header">
                    <apex:commandLink value="Apartment" action="{!toggleSort}" rerender="results,debug">
                        <apex:param name="sortField" value="apt" assignTo="{!sortField}"/>
                    </apex:commandLink>
                 </apex:facet>
                 <apex:outputPanel rendered="{!IF( provider.DEL_Provider_Addresses__r != null && provider.DEL_Provider_Addresses__r.size > 0,true, false)}">
                    <apex:outputText value="{!provider.DEL_Provider_Addresses__r[0].DD_Apartment_Number__c}"/>
                </apex:outputPanel>
            </apex:column>

          

        </apex:pageBlockTable>
 
    
    </apex:pageBlock>

    </td>
      
  </tr>
  
  </table>
  
  <apex:pageBlock title="Debug - SOQL" id="debug">
      <apex:outputText value="{!debugSoql}" />           
  </apex:pageBlock>    

  </apex:pageBlock>

  </apex:form>
</apex:page>